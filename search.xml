<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Showdown</title>
      <link href="2021/05/26/Showdown/"/>
      <url>2021/05/26/Showdown/</url>
      
        <content type="html"><![CDATA[<p>Showdown is a Javascript Markdown to HTML converter, based on the original works by John Gruber. It can be used client side (in the browser) or server side (with Node or io). </p><h1 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h1><h2 id="Download-tarball"><a href="#Download-tarball" class="headerlink" title="Download tarball"></a>Download tarball</h2><p>You can download the latest release tarball directly from <a href="https://github.com/showdownjs/showdown/releases">releases</a></p><h2 id="Bower"><a href="#Bower" class="headerlink" title="Bower"></a>Bower</h2><pre><code>bower install showdown</code></pre><h2 id="npm-server-side"><a href="#npm-server-side" class="headerlink" title="npm (server-side)"></a>npm (server-side)</h2><pre><code>npm install showdown</code></pre><h2 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h2><p>You can also use one of several CDNs available: </p><ul><li><p>rawgit CDN</p><pre><code>  https://cdn.rawgit.com/showdownjs/showdown/&lt;version tag&gt;/dist/showdown.min.js</code></pre></li><li><p>cdnjs</p><pre><code>  https://cdnjs.cloudflare.com/ajax/libs/showdown/&lt;version tag&gt;/showdown.min.js</code></pre></li></ul><hr><h1 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h1><h2 id="Table-of-contents"><a href="#Table-of-contents" class="headerlink" title="Table of contents"></a>Table of contents</h2><ul><li><a href="#introduction">Introduction</a></li><li><a href="#paragraphs">Paragraphs</a></li><li><a href="#headings">Headings</a><ul><li><a href="#atx-style">Atx Style</a></li><li><a href="#setext-style">Setext style</a></li><li><a href="#header-ids">Header IDs</a></li></ul></li><li><a href="#blockquotes">Blockquotes</a></li><li><a href="#bold-and-italic">Bold and Italic</a></li><li><a href="#strikethrough">Strikethrough</a></li><li><a href="#emojis">Emojis</a></li><li><a href="#code-formatting">Code formatting</a><ul><li><a href="#inline-formats">Inline formats</a></li><li><a href="#multiple-lines">Multiple lines</a></li></ul></li><li><a href="#lists">Lists</a><ul><li><a href="#unordered-lists">Unordered lists</a></li><li><a href="#ordered-lists">Ordered lists</a></li><li><a href="#tasklists--gfm-style-">TaskLists (GFM Style)</a></li><li><a href="#list-syntax">List syntax</a></li><li><a href="#nested-blocks">Nested blocks</a></li><li><a href="#nested-lists">Nested lists</a></li><li><a href="#nested-code-blocks">Nested code blocks</a></li></ul></li><li><a href="#links">Links</a><ul><li><a href="#simple">Simple</a></li><li><a href="#inline">Inline</a></li><li><a href="#reference-style">Reference Style</a></li></ul></li><li><a href="#images">Images</a><ul><li><a href="#inline-1">Inline</a></li><li><a href="#reference-style-1">Reference Style</a></li><li><a href="#image-dimensions">Image dimensions</a></li><li><a href="#base64-encoded-images">Base64 encoded images</a></li></ul></li><li><a href="#tables">Tables</a></li><li><a href="#mentions">Mentions</a></li><li><a href="#handling-html-in-markdown-documents">Handling HTML in markdown documents</a></li><li><a href="#escaping-entities">Escaping entities</a><ul><li><a href="#escaping-markdown-entities">Escaping markdown entities</a></li><li><a href="#escaping-html-tags">Escaping html tags</a></li></ul></li><li><a href="#known-differences-and-gotchas">Known differences and Gotchas</a></li></ul><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Showdown was created by John Fraser as a direct port of the original parser written by markdown’s creator, John Gruber. Although Showdown has evolved since its inception, in “vanilla mode”, it tries to follow the <a href="http://daringfireball.net/projects/markdown/">original markdown spec</a> (henceforth refereed as vanilla) as much as possible. There are, however, a few important differences, mainly due to inconsistencies in the original spec, which we addressed following the author’s advice as stated in the <a href="https://pairlist6.pair.net/mailman/listinfo/markdown-discuss">markdown’s “official” newsletter</a>.</p><p>Showdown also support “extra” syntax not defined in the original spec as opt-in features. This means new syntax elements are not enabled by default and require users to enable them through options.</p><p>This document provides a quick description the syntax supported and the differences in output from the original markdown.pl implementation.</p><h2 id="Paragraphs"><a href="#Paragraphs" class="headerlink" title="Paragraphs"></a>Paragraphs</h2><p>Paragraphs in Showdown are just <strong>one or more lines of consecutive text</strong> followed by one or more blank lines.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">On July 2, an alien mothership entered Earth&#x27;s orbit and deployed several dozen </span><br><span class="line">saucer-shaped &quot;destroyer&quot; spacecraft, each 15 miles (24 km) wide.</span><br><span class="line"><span class="code">    </span></span><br><span class="line"><span class="code">On July 3, the Black Knights, a squadron of Marine Corps F/A-18 Hornets, </span></span><br><span class="line"><span class="code">participated in an assault on a destroyer near the city of Los Angeles.</span></span><br></pre></td></tr></table></figure><p>The implication of the “one or more consecutive lines of text” is that Showdown supports<br>“hard-wrapped” text paragraphs. This means the following examples produce the same output:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A very long line of text</span><br></pre></td></tr></table></figure><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A very</span><br><span class="line">long line</span><br><span class="line">of text</span><br></pre></td></tr></table></figure><p>If you DO want to add soft line breaks (which translate to <code>&lt;br&gt;</code> in HTML) to a paragraph,<br>you can do so by adding 3 space characters to the end of the line (<code>  </code>).</p><p>You can also force every line break in paragraphs to translate to <code>&lt;br&gt;</code> (as Github does) by<br>enabling the option <strong><code>simpleLineBreaks</code></strong>.</p><h2 id="Headings"><a href="#Headings" class="headerlink" title="Headings"></a>Headings</h2><h3 id="Atx-Style"><a href="#Atx-Style" class="headerlink" title="Atx Style"></a>Atx Style</h3><p>You can create a heading by adding one or more # symbols before your heading text. The number of # you use will determine the size of the heading. This is similar to <a href="http://www.aaronsw.com/2002/atx/intro"><strong>atx style</strong></a>.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># The largest heading (an <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span> tag)</span></span><br><span class="line"><span class="section">## The second largest heading (an <span class="xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span></span> tag)</span></span><br><span class="line">…</span><br><span class="line"><span class="section">###### The 6th largest heading (an <span class="xml"><span class="tag">&lt;<span class="name">h6</span>&gt;</span></span> tag)</span></span><br></pre></td></tr></table></figure><p>The space between <code>#</code> and the heading text is not required but you can make that space mandatory by enabling the option <strong><code>requireSpaceBeforeHeadingText</code></strong>.</p><p>You can wrap the headings in <code>#</code>. Both leading and trailing <code>#</code> will be removed.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">## My Heading ##</span></span><br></pre></td></tr></table></figure><p>If, for some reason, you need to keep a leading or trailing <code>#</code>, you can either add a space or escape it:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># # My header # #</span></span><br><span class="line"></span><br><span class="line"><span class="section">#\# My Header \# #</span></span><br></pre></td></tr></table></figure><h3 id="Setext-style"><a href="#Setext-style" class="headerlink" title="Setext style"></a>Setext style</h3><p>You can also use <a href="https://en.wikipedia.org/wiki/Setext"><strong>setext style</strong></a> headings, although only two levels are available.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">This is an H1</span></span><br><span class="line"><span class="section">=============</span></span><br><span class="line"><span class="code">    </span></span><br><span class="line"><span class="code">This is an H2</span></span><br><span class="line"><span class="code">-------------</span></span><br></pre></td></tr></table></figure><p><strong>Note:</strong><br>In live preview editors, when a paragraph is followed by a list it can cause an awkward effect.</p><p><img src="http://i.imgur.com/YQ9iHTL.gif" alt="awkward effect"></p><p>You can prevent this by enabling the option <strong><code>smoothPreview</code></strong>.</p><h3 id="Header-IDs"><a href="#Header-IDs" class="headerlink" title="Header IDs"></a>Header IDs</h3><p>Showdown generates bookmarks anchors in titles automatically, by adding an id property to an heading.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># My cool header with ID</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">&quot;mycoolheaderwithid&quot;</span>&gt;</span>My cool header with ID<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p>This behavior can be modified with options:</p><ul><li><strong><code>noHeaderId</code></strong> disables automatic id generation; </li><li><strong><code>ghCompatibleHeaderId</code></strong> generates header ids compatible with github style (spaces are replaced with dashes and a bunch of non alphanumeric chars are removed)</li><li><strong><code>prefixHeaderId</code></strong> adds a prefix to the generated header ids (either automatic or custom).</li><li><strong><code>headerLevelStart</code></strong> sets the header starting level. For instance, setting this to 3 means that <code># header</code> will be converted to <code>&lt;h3&gt;</code>.</li></ul><p>Read the <a href="https://github.com/showdownjs/showdown/blob/master/README.md">README.md</a> for more info</p><h2 id="Blockquotes"><a href="#Blockquotes" class="headerlink" title="Blockquotes"></a>Blockquotes</h2><p>You can indicate blockquotes with a &gt;.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In the words of Abraham Lincoln:</span><br><span class="line"><span class="code">    </span></span><br><span class="line"><span class="code">&gt; Pardon my french</span></span><br></pre></td></tr></table></figure><p>Blockquotes can have multiple paragraphs and can have other block elements inside.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt; A paragraph of text</span></span><br><span class="line"><span class="quote">&gt;</span></span><br><span class="line"><span class="quote">&gt; Another paragraph</span></span><br><span class="line"><span class="quote">&gt;</span></span><br><span class="line"><span class="quote">&gt; - A list</span></span><br><span class="line"><span class="quote">&gt; - with items</span></span><br></pre></td></tr></table></figure><h2 id="Bold-and-Italic"><a href="#Bold-and-Italic" class="headerlink" title="Bold and Italic"></a>Bold and Italic</h2><p>You can make text bold or italic.</p><pre><code>*This text will be italic***This text will be bold**</code></pre><p>Both bold and italic can use either a * or an _ around the text for styling. This allows you to combine both bold and italic if needed.</p><pre><code>**Everyone _must_ attend the meeting at 5 o&#39;clock today.**</code></pre><h2 id="Strikethrough"><a href="#Strikethrough" class="headerlink" title="Strikethrough"></a>Strikethrough</h2><p>With the option <strong><code>strikethrough</code></strong> enabled, Showdown supports strikethrough elements.<br>The syntax is the same as GFM, that is, by adding two tilde (<code>~~</code>) characters around<br>a word or groups of words.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a ~~strikethrough~~ element</span><br></pre></td></tr></table></figure><p>a <del>strikethrough</del> element</p><h2 id="Emojis"><a href="#Emojis" class="headerlink" title="Emojis"></a>Emojis</h2><p>Since version 1.8.0, showdown supports github’s emojis. A complete list of available emojis can be foun <a href="https://github.com/showdownjs/showdown/wiki/emojis">here</a>.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this is a :smile: smile emoji</span><br></pre></td></tr></table></figure><p>this is a :smile: smile emoji</p><h2 id="Code-formatting"><a href="#Code-formatting" class="headerlink" title="Code formatting"></a>Code formatting</h2><h3 id="Inline-formats"><a href="#Inline-formats" class="headerlink" title="Inline formats"></a>Inline formats</h3><p>Use single backticks (`) to format text in a special monospace format. Everything within the backticks appear as-is, with no other special formatting.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Here&#x27;s an idea: why don&#x27;t we take <span class="code">`SuperiorProject`</span> and turn it into <span class="code">`**Reasonable**Project`</span>.</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Here&#x27;s an idea: why don&#x27;t we take <span class="tag">&lt;<span class="name">code</span>&gt;</span>SuperiorProject<span class="tag">&lt;/<span class="name">code</span>&gt;</span> and turn it into <span class="tag">&lt;<span class="name">code</span>&gt;</span>**Reasonable**Project<span class="tag">&lt;/<span class="name">code</span>&gt;</span>.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Multiple-lines"><a href="#Multiple-lines" class="headerlink" title="Multiple lines"></a>Multiple lines</h3><p>To create blocks of code you should indent it by four spaces.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">this is a piece</span><br><span class="line">of</span><br><span class="line">code</span><br></pre></td></tr></table></figure><p>If the options <strong><code>ghCodeBlocks</code></strong> is activated (which is by default), you can use triple backticks (```) to format text as its own distinct block.</p><pre><code>Check out this neat program I wrote:<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x = 0</span><br><span class="line">x = 2 + 2</span><br><span class="line">what is x</span><br></pre></td></tr></table></figure></code></pre><h2 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h2><p>Showdown supports ordered (numbered) and unordered (bulleted) lists.</p><h3 id="Unordered-lists"><a href="#Unordered-lists" class="headerlink" title="Unordered lists"></a>Unordered lists</h3><p>You can make an unordered list by preceding list items with either a *, a - or a +. Markers are interchangeable too.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span> Item</span><br><span class="line"><span class="bullet">+</span> Item</span><br><span class="line"><span class="bullet">-</span> Item</span><br></pre></td></tr></table></figure><h3 id="Ordered-lists"><a href="#Ordered-lists" class="headerlink" title="Ordered lists"></a>Ordered lists</h3><p>You can make an ordered list by preceding list items with a number.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> Item 1</span><br><span class="line"><span class="bullet">2.</span> Item 2</span><br><span class="line"><span class="bullet">3.</span> Item 3</span><br></pre></td></tr></table></figure><p>It’s important to note that the actual numbers you use to mark the list have no effect on the HTML output Showdown produces. So you can use the same number in all items if you wish to.</p><h3 id="TaskLists-GFM-Style"><a href="#TaskLists-GFM-Style" class="headerlink" title="TaskLists (GFM Style)"></a>TaskLists (GFM Style)</h3><p>Showdown also supports GFM styled takslists if the <strong><code>tasklists</code></strong> option is enabled.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> [x] checked list item</span><br><span class="line"><span class="bullet">-</span> [ ] unchecked list item</span><br></pre></td></tr></table></figure><ul><li><input checked="" disabled="" type="checkbox"> checked list item</li><li><input disabled="" type="checkbox"> unchecked list item</li></ul><h3 id="List-syntax"><a href="#List-syntax" class="headerlink" title="List syntax"></a>List syntax</h3><p>List markers typically start at the left margin, but may be indented by up to three spaces. </p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span> this is valid</span><br><span class="line"><span class="bullet">*</span> this is too  </span><br></pre></td></tr></table></figure><p>List markers must be followed by one or more spaces or a tab.</p><p>To make lists look nice, you can wrap items with hanging indents:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span>   Lorem ipsum dolor sit amet, consectetuer adipiscing elit.</span><br><span class="line"><span class="code">    Aliquam hendrerit mi posuere lectus. Vestibulum enim wisi,</span></span><br><span class="line"><span class="code">    viverra nec, fringilla in, laoreet vitae, risus.</span></span><br><span class="line"><span class="code">*   Donec sit amet nisl. Aliquam semper ipsum sit amet velit.</span></span><br><span class="line"><span class="code">    Suspendisse id sem consectetuer libero luctus adipiscing.</span></span><br></pre></td></tr></table></figure><p>But if you want to be lazy, you don’t have to</p><p>If one list item is separated by a blank line, Showdown will wrap all the list items in <code>&lt;p&gt;</code> tags in the HTML output.<br>So this input:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span> Bird</span><br><span class="line"></span><br><span class="line"><span class="bullet">*</span> Magic</span><br><span class="line"><span class="bullet">*</span> Johnson</span><br></pre></td></tr></table></figure><p>Results in:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>Bird<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>Magic<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>Johnson<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><p>This differs from other markdown implementations such as GFM (github) or commonmark.  </p><h3 id="Nested-blocks"><a href="#Nested-blocks" class="headerlink" title="Nested blocks"></a>Nested blocks</h3><p>List items may consist of multiple paragraphs. Each subsequent paragraph in a list item must be indented by either 4 spaces or one tab:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span>  This is a list item with two paragraphs. Lorem ipsum dolor</span><br><span class="line"><span class="code">    sit amet, consectetuer adipiscing elit. Aliquam hendrerit</span></span><br><span class="line"><span class="code">    mi posuere lectus.</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="code">    Vestibulum enim wisi, viverra nec, fringilla in, laoreet</span></span><br><span class="line"><span class="code">    vitae, risus. Donec sit amet nisl. Aliquam semper ipsum</span></span><br><span class="line"><span class="code">    sit amet velit.</span></span><br><span class="line"><span class="code"></span></span><br><span class="line"><span class="bullet">2.</span>  Suspendisse id sem consectetuer libero luctus adipiscing.</span><br></pre></td></tr></table></figure><p>This is valid for other block elements such as blockquotes:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span>   A list item with a blockquote:</span><br><span class="line"></span><br><span class="line"><span class="code">    &gt; This is a blockquote</span></span><br><span class="line"><span class="code">    &gt; inside a list item.</span></span><br></pre></td></tr></table></figure><p>or event other lists.</p><h3 id="Nested-lists"><a href="#Nested-lists" class="headerlink" title="Nested lists"></a>Nested lists</h3><p>You can create nested lists by indenting list items by <strong>four</strong> spaces.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span>  Item 1</span><br><span class="line"><span class="bullet">    1.</span> A corollary to the above item.</span><br><span class="line"><span class="bullet">    2.</span> Yet another point to consider.</span><br><span class="line"><span class="bullet">2.</span>  Item 2</span><br><span class="line"><span class="bullet">    *</span> A corollary that does not need to be ordered.</span><br><span class="line"><span class="bullet">    *</span> This is indented four spaces</span><br><span class="line"><span class="bullet">    *</span> You might want to consider making a new list.</span><br><span class="line"><span class="bullet">3.</span>  Item 3</span><br></pre></td></tr></table></figure><p>This behavior is consistent with the original spec but differs from other implementations such as GFM or commonmark. Prior to version 1.5, you just needed to indent two spaces for it to be considered a sublist.<br>You can disable the <strong>four spaces requirement</strong> with option <strong><code>disableForced4SpacesIndentedSublists</code></strong></p><p>To nest a third (or more) sublist level, you need to indent 4 extra spaces (or 1 extra tab) for each level.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span>  level 1</span><br><span class="line"><span class="bullet">    1.</span>  Level 2</span><br><span class="line"><span class="bullet">        *</span>   Level 3</span><br><span class="line"><span class="bullet">    2.</span>  level 2</span><br><span class="line"><span class="bullet">        1.</span>  Level 3</span><br><span class="line"><span class="bullet">1.</span>  Level 1</span><br></pre></td></tr></table></figure><h3 id="Nested-code-blocks"><a href="#Nested-code-blocks" class="headerlink" title="Nested code blocks"></a>Nested code blocks</h3><p>You can nest fenced codeblocks the same way you nest other block elements, by indenting by fours spaces or a tab:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span>  Some code:</span><br><span class="line"></span><br><span class="line"><span class="code">    ```js</span></span><br><span class="line"><span class="code">    var foo = &#x27;bar&#x27;;</span></span><br><span class="line"><span class="code">    console.log(foo);</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">To put a *indented style* code block within a list item, the code block needs to be indented twice — 8 spaces or two tabs:</span><br><span class="line"></span><br><span class="line">```md</span><br><span class="line">1.  Some code:</span><br><span class="line"></span><br><span class="line">    var foo = &#x27;bar&#x27;;</span><br><span class="line">    console.log(foo);</span><br></pre></td></tr></table></figure><h2 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h2><h3 id="Simple"><a href="#Simple" class="headerlink" title="Simple"></a>Simple</h3><p>If you wrap a valid URL or email in <code>&lt;&gt;</code> it will be turned into a link whose text is the link itself.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">link to <span class="xml">&lt;http://www.google.com/&gt;</span></span><br><span class="line"></span><br><span class="line">this is my email <span class="xml">&lt;somedude@mail.com&gt;</span></span><br></pre></td></tr></table></figure><p>In the case of email addreses, Showdown will also perform a bit of randomized decimal and hex entity-encoding to help obscure your address from address-harvesting spambots.<br>You can disable this obfuscation setting <strong><code>encodeEmails</code></strong> option to <code>false</code>.</p><p>With the option <strong><code>simplifiedAutoLink</code></strong> enabled, Showdown will automagically turn every valid URL it finds in the text body to links for you, without the need to wrap them in <code>&lt;&gt;</code>.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">link to http://www.google.com/</span><br><span class="line"></span><br><span class="line">this is my email somedude@mail.com</span><br></pre></td></tr></table></figure><h3 id="Inline"><a href="#Inline" class="headerlink" title="Inline"></a>Inline</h3><p>You can create an inline link by wrapping link text in brackets ( <code>[ ]</code> ), and then wrapping the link in parentheses ( <code>( )</code> ).</p><p>For example, to create a hyperlink to github.com/showdownjs/showdown, with a link text that says, Get Showdown!, you’d write this in Markdown: <code>[Get Showdown!](https://github.com/showdownjs/showdown)</code>.</p><h3 id="Reference-Style"><a href="#Reference-Style" class="headerlink" title="Reference Style"></a>Reference Style</h3><p>You can also use the reference style, like this:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">this is a [<span class="string">link to google</span>][<span class="symbol">1</span>]</span><br><span class="line"></span><br><span class="line">[<span class="symbol">1</span>]: <span class="link">www.google.com</span></span><br></pre></td></tr></table></figure><p>Showdown also supports implicit link references:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">this is a link to [<span class="string">google</span>][<span class="symbol"></span>]</span><br><span class="line"></span><br><span class="line">[<span class="symbol">google</span>]: <span class="link">www.google.com</span></span><br></pre></td></tr></table></figure><h2 id="Images"><a href="#Images" class="headerlink" title="Images"></a>Images</h2><p>Markdown uses an image syntax that is intended to resemble the syntax for links, also allowing for two styles: inline and reference.</p><h3 id="Inline-1"><a href="#Inline-1" class="headerlink" title="Inline"></a>Inline</h3><p>Inline image syntax looks like this:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">Alt text</span>](<span class="link">url/to/image</span>)</span><br><span class="line"></span><br><span class="line">![<span class="string">Alt text</span>](<span class="link">url/to/image &quot;Optional title&quot;</span>)</span><br></pre></td></tr></table></figure><p>That is:</p><ul><li>An exclamation mark: !;</li><li>followed by a set of square brackets, containing the alt attribute text for the image;</li><li>followed by a set of parentheses, containing the URL or path to the image, and an optional title attribute enclosed in double or single quotes.</li></ul><h3 id="Reference-Style-1"><a href="#Reference-Style-1" class="headerlink" title="Reference Style"></a>Reference Style</h3><p>Reference-style image syntax looks like this:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">Alt text</span>][<span class="symbol">id</span>]</span><br></pre></td></tr></table></figure><p>Where “id” is the name of a defined image reference. Image references are defined using syntax identical to link references:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">id</span>]: <span class="link">url/to/image  &quot;Optional title attribute&quot;</span></span><br></pre></td></tr></table></figure><p>Implicit references are also supported in images, similar to what happens with links:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">showdown logo</span>][<span class="symbol"></span>]</span><br><span class="line"></span><br><span class="line">[<span class="symbol">showdown logo</span>]: <span class="link">http://showdownjs.github.io/demo/img/editor.logo.white.png</span></span><br></pre></td></tr></table></figure><h3 id="Image-dimensions"><a href="#Image-dimensions" class="headerlink" title="Image dimensions"></a>Image dimensions</h3><p>When the option <strong><code>parseImgDimension</code></strong> is activated, you can also define the image dimensions, like this:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">Alt text</span>](<span class="link">url/to/image =250x250 &quot;Optional title&quot;</span>)</span><br></pre></td></tr></table></figure><p>or in reference style:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">Alt text</span>][<span class="symbol">id</span>]</span><br><span class="line"></span><br><span class="line">[<span class="symbol">id</span>]: <span class="link">url/to/image =250x250</span></span><br></pre></td></tr></table></figure><h3 id="Base64-encoded-images"><a href="#Base64-encoded-images" class="headerlink" title="Base64 encoded images"></a>Base64 encoded images</h3><p>Showdown also supports Base64 encoded images, both reference and inline style.<br><strong>Since version 1.7.4</strong>, wrapping base64 strings, which are usually extremely long lines of text, is supported.<br>You can add newlines arbitrarily, as long as they are added after the <code>,</code> character.</p><p><strong>inline style</strong></p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">![Alt text](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7l</span><br><span class="line">jmRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAY</span><br><span class="line">SURBVBhXYwCC/2AAZYEoOAMs8Z+BgQEAXdcR7/Q1gssAAAAASUVORK5CYII=)</span><br></pre></td></tr></table></figure><p><strong>reference style</strong></p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">Alt text</span>][<span class="symbol">id</span>]</span><br><span class="line"></span><br><span class="line">[<span class="symbol">id</span>]:</span><br><span class="line"><span class="link">data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7l</span></span><br><span class="line">jmRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7D</span><br><span class="line">AcdvqGQAAAAYSURBVBhXYwCC/2AAZYEoOAMs8Z+BgQEAXdcR7/Q1gssAAAAASUVORK5CYII=</span><br></pre></td></tr></table></figure><p>Please note that with reference style base64 image sources, regardless of “wrapping”, a double newline is needed after the base64 string to separate them from a paragraph or other text block (but references can be adjacent).</p><p><strong>wrapped reference style</strong></p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">Alt text</span>][<span class="symbol">id</span>]</span><br><span class="line">![<span class="string">Alt text</span>][<span class="symbol">id2</span>]</span><br><span class="line"></span><br><span class="line">[<span class="symbol">id</span>]:</span><br><span class="line"><span class="link">data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7l</span></span><br><span class="line">jmRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7D</span><br><span class="line">AcdvqGQAAAAYSURBVBhXYwCC/2AAZYEoOAMs8Z+BgQEAXdcR7/Q1gssAAAAASUVORK5CYII=</span><br><span class="line">[<span class="symbol">id2</span>]:</span><br><span class="line"><span class="link">data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAIAAAA7l</span></span><br><span class="line">jmRAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7D</span><br><span class="line">AcdvqGQAAAAYSURBVBhXYwCC/2AAZYEoOAMs8Z+BgQEAXdcR7/Q1gssAAAAASUVORK5CYII=</span><br><span class="line"></span><br><span class="line">this text needs to be separated from the references by 2 newlines</span><br></pre></td></tr></table></figure><h2 id="Tables"><a href="#Tables" class="headerlink" title="Tables"></a>Tables</h2><p>Tables aren’t part of the core Markdown spec, but they are part of GFM and Showdown supports them by turning on the option <code>tables</code>.</p><p>Colons can be used to align columns.</p><p>In the new version, the outer pipes (<code>|</code>) are optional, matching GFM spec. </p><p>You also don’t need to make the raw Markdown line up prettily.</p><p>You can also use other markdown syntax inside them.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| Tables        | Are           | Cool  |</span><br><span class="line">| ------------- |:-------------:| -----:|</span><br><span class="line">| <span class="strong">**col 3 is**</span>  | right-aligned | $1600 |</span><br><span class="line">| col 2 is      | <span class="emphasis">*centered*</span>    |   $12 |</span><br><span class="line">| zebra stripes | ~~are neat~~  |    $1 |</span><br></pre></td></tr></table></figure><h2 id="Mentions"><a href="#Mentions" class="headerlink" title="Mentions"></a>Mentions</h2><p>Showdown supports github mentions by enabling the option <strong><code>ghMentions</code></strong>. This will turn every <code>@username</code> into a link to their github profile.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hey @tivie, check this out</span><br></pre></td></tr></table></figure><p>Since version 1.6.2 you can customize the generated link in mentions with the option <strong><code>ghMentionsLink</code></strong>.<br>For instance, setting this option to <code>http://mysite.com/&#123;u&#125;/profile</code>:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>hey <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://mysite.com/tivie/profile&quot;</span>&gt;</span>@tivie<span class="tag">&lt;/<span class="name">a</span>&gt;</span>, check this out<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Handling-HTML-in-markdown-documents"><a href="#Handling-HTML-in-markdown-documents" class="headerlink" title="Handling HTML in markdown documents"></a>Handling HTML in markdown documents</h2><p>Showdown, in most cases, leaves HTML tags alone, leaving them untouched in the output document.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">some markdown <span class="strong">**here**</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span>this is <span class="emphasis">*not*</span> <span class="strong">**parsed**</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>some markdown <span class="tag">&lt;<span class="name">strong</span>&gt;</span>here<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>this is *not* **parsed**<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p>However, there are exceptions to this. With <code>&lt;code&gt;</code> and <code>&lt;pre&gt;&lt;code&gt;</code> tags, their contents are always escaped.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">some markdown <span class="strong">**here**</span> with <span class="xml"><span class="tag">&lt;<span class="name">code</span>&gt;</span></span>foo &amp; bar <span class="xml"><span class="tag">&lt;<span class="name">baz</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">baz</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">code</span>&gt;</span></span></span><br></pre></td></tr></table></figure> <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>some markdown <span class="tag">&lt;<span class="name">strong</span>&gt;</span>here<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> with <span class="tag">&lt;<span class="name">code</span>&gt;</span>foo <span class="symbol">&amp;amp;</span> bar <span class="symbol">&amp;lt;</span>baz<span class="symbol">&amp;gt;</span><span class="symbol">&amp;lt;</span>/baz<span class="symbol">&amp;gt;</span><span class="tag">&lt;/<span class="name">code</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>If you wish to enable markdown parsing inside a specific HTML tag, you can enable it by using the html attribute <strong><code>markdown</code></strong> or  <strong><code>markdown=&quot;1&quot;</code></strong>  or <strong><code>data-markdown=&quot;1&quot;</code></strong>.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">some markdown <span class="strong">**here**</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">markdown</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span>this is <span class="emphasis">*not*</span> <span class="strong">**parsed**</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>some markdown <span class="tag">&lt;<span class="name">strong</span>&gt;</span>here<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">markdown</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>this is <span class="tag">&lt;<span class="name">em</span>&gt;</span>not<span class="tag">&lt;/<span class="name">em</span>&gt;</span> <span class="tag">&lt;<span class="name">strong</span>&gt;</span>parsed<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Escaping-entities"><a href="#Escaping-entities" class="headerlink" title="Escaping entities"></a>Escaping entities</h2><h3 id="Escaping-markdown-entities"><a href="#Escaping-markdown-entities" class="headerlink" title="Escaping markdown entities"></a>Escaping markdown entities</h3><p>Showdown allows you to use backslash (<code>\</code>) escapes to generate literal characters which would otherwise have special meaning in markdown’s syntax. For example, if you wanted to surround a word with literal underscores (instead of an HTML <code>&lt;em&gt;</code> tag), you can use backslashes before the unserscores, like this:</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\<span class="emphasis">_literal underscores\_</span></span><br></pre></td></tr></table></figure><p>Showdown provides backslash escapes for the following characters:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">\   backslash</span><br><span class="line">`   backtick</span><br><span class="line">*   asterisk</span><br><span class="line">_   underscore</span><br><span class="line">&#123;&#125;  curly braces</span><br><span class="line">[]  square brackets</span><br><span class="line">()  parentheses</span><br><span class="line">#   hash mark</span><br><span class="line">+   plus sign</span><br><span class="line">-   minus sign (hyphen)</span><br><span class="line">.   dot</span><br><span class="line">!   exclamation mark</span><br></pre></td></tr></table></figure><h3 id="Escaping-HTML-tags"><a href="#Escaping-HTML-tags" class="headerlink" title="Escaping HTML tags"></a>Escaping HTML tags</h3><p>Since <a href="https://github.com/showdownjs/showdown/tree/1.7.2">version 1.7.2</a> backslash escaping HTML tags is supported when <code>backslashEscapesHTMLTags</code> option is enabled.</p><figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span>a literal div\<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="Known-differences-and-Gotchas"><a href="#Known-differences-and-Gotchas" class="headerlink" title="Known differences and Gotchas"></a>Known differences and Gotchas</h2><p>In most cases, Showdown’s output is identical to that of Perl Markdown v1.0.2b7.  What follows is a list of all known deviations.  Please file an issue if you find more.</p><ul><li><p><strong>Since version 1.4.0, showdown supports the markdown=”1” attribute</strong>, but for older versions, this attribute is ignored. This means:</p><pre><code>  &lt;div markdown=&quot;1&quot;&gt;       Markdown does *not* work in here.  &lt;/div&gt;</code></pre></li></ul><ul><li><p>You can only nest square brackets in link titles to a depth of two levels:</p><pre><code>  [[fine]](http://www.github.com/)  [[[broken]]](http://www.github.com/)</code></pre><p>  If you need more, you can escape them with backslashes.</p></li></ul><ul><li><p>A list is <strong>single paragraph</strong> if it has only <strong>1 line-break separating items</strong> and it becomes <strong>multi paragraph if ANY of its items is separated by 2 line-breaks</strong>:</p> <figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> foo</span><br><span class="line">   </span><br><span class="line"><span class="bullet">-</span> bar</span><br><span class="line"><span class="bullet">-</span> baz</span><br></pre></td></tr></table></figure><p> becomes</p>  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>foo<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>bar<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>baz<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p>This new ruleset is based on the comments of Markdown’s author John Gruber in the <a href="https://pairlist6.pair.net/mailman/listinfo/markdown-discuss">Markdown discussion list</a>.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="2021/05/26/hello-world/"/>
      <url>2021/05/26/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Install K8S in centos7</title>
      <link href="2021/01/09/Install-K8S-in-centos7/"/>
      <url>2021/01/09/Install-K8S-in-centos7/</url>
      
        <content type="html"><![CDATA[<h2 id="虚拟机centos7搭建k8s"><a href="#虚拟机centos7搭建k8s" class="headerlink" title="虚拟机centos7搭建k8s"></a>虚拟机centos7搭建k8s</h2><h2 id="1、踩坑大全"><a href="#1、踩坑大全" class="headerlink" title="1、踩坑大全"></a>1、踩坑大全</h2><ol><li>centos7安装的docker后，默认非root用户无法使用，所以需要创建docker组，把当前普通用户加入到组中，这里参考链接：<a href="https://stackoverflow.com/questions/48957195/how-to-fix-docker-got-permission-denied-issue">设置docker非root用户正常使用</a></li><li>在给docker配置镜像加速地址，daemon.json中追加registry-mirrors时，没有加入上一行的逗号，导致docker重启失败，加入逗号，daemon.json符合json文件规范就可以了，如下图所示是失败案例：<br><img src="https://img-blog.csdnimg.cn/20210109133114411.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3BpcmF0ZXNqamNm,size_16,color_FFFFFF,t_70#pic_center" alt="途中红圈处要追加逗号"></li></ol><h2 id="2、入门学习"><a href="#2、入门学习" class="headerlink" title="2、入门学习"></a>2、入门学习</h2><ol><li>master节点默认程序：<br><img src="https://img-blog.csdnimg.cn/2021010912511823.PNG#pic_center" alt="在这里插入图片描述"></li><li>slave节点默认程序：<br><img src="https://img-blog.csdnimg.cn/20210109125148921.PNG#pic_center" alt="在这里插入图片描述"></li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>AIDL原理和相关文件解析</title>
      <link href="2019/03/20/AIDL%E5%8E%9F%E7%90%86%E5%92%8C%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90/"/>
      <url>2019/03/20/AIDL%E5%8E%9F%E7%90%86%E5%92%8C%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h2 id="Binder概述"><a href="#Binder概述" class="headerlink" title="Binder概述"></a>Binder概述</h2><p>&ensp;&ensp;相信从事Android相关的研发人员，都对Binder有个或多或少的了解，相关技术博客也有一大推，我今天对Binder的学习过程进行一个记录，理论性的叙述会少一点，更多的是基于AS自动生成的AIDL文件进行代码分析。但读者事先应该对Binder的Server、Client、ServerManager和Binder驱动要有一定的了解。</p><h2 id="AIDL代码简单分析"><a href="#AIDL代码简单分析" class="headerlink" title="AIDL代码简单分析"></a>AIDL代码简单分析</h2><h3 id="接口总览"><a href="#接口总览" class="headerlink" title="接口总览"></a>接口总览</h3><p>&ensp;&ensp;看过《Android开发艺术探索》的同行应该记得，有个经典的BookManager的Demo，如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line">public interface BookManager extends android.os.IInterface &#123;</span><br><span class="line">    /**</span><br><span class="line">     * Local-side IPC implementation stub class.</span><br><span class="line">     */</span><br><span class="line">    public static abstract class Stub extends android.os.Binder implements android.tplink.sjj.aidltest.BookManager &#123;</span><br><span class="line">        private static final java.lang.String DESCRIPTOR = &quot;android.tplink.sjj.aidltest.BookManager&quot;;</span><br><span class="line"></span><br><span class="line">        /**</span><br><span class="line">         * Construct the stub at attach it to the interface.</span><br><span class="line">         */</span><br><span class="line">        public Stub() &#123;</span><br><span class="line">            this.attachInterface(this, DESCRIPTOR);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        /**</span><br><span class="line">         * Cast an IBinder object into an android.tplink.sjj.aidltest.BookManager interface,</span><br><span class="line">         * generating a proxy if needed.</span><br><span class="line">         */</span><br><span class="line">        public static android.tplink.sjj.aidltest.BookManager asInterface(android.os.IBinder obj) &#123;</span><br><span class="line">            if ((obj == null)) &#123;</span><br><span class="line">                return null;</span><br><span class="line">            &#125;</span><br><span class="line">            android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR);</span><br><span class="line">            if (((iin != null) &amp;&amp; (iin instanceof android.tplink.sjj.aidltest.BookManager))) &#123;</span><br><span class="line">                return ((android.tplink.sjj.aidltest.BookManager) iin);</span><br><span class="line">            &#125;</span><br><span class="line">            return new android.tplink.sjj.aidltest.BookManager.Stub.Proxy(obj);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public android.os.IBinder asBinder() &#123;</span><br><span class="line">            return this;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public boolean onTransact(int code, android.os.Parcel data, android.os.Parcel reply, int flags) throws android.os.RemoteException &#123;</span><br><span class="line">            java.lang.String descriptor = DESCRIPTOR;</span><br><span class="line">            switch (code) &#123;</span><br><span class="line">            case INTERFACE_TRANSACTION: &#123;</span><br><span class="line">                reply.writeString(descriptor);</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">            case TRANSACTION_getBooks: &#123;</span><br><span class="line">                data.enforceInterface(descriptor);</span><br><span class="line">                java.util.List&lt;android.tplink.sjj.aidltest.Book&gt; _result = this.getBooks();</span><br><span class="line">                reply.writeNoException();</span><br><span class="line">                reply.writeTypedList(_result);</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">            case TRANSACTION_addBook: &#123;</span><br><span class="line">                data.enforceInterface(descriptor);</span><br><span class="line">                android.tplink.sjj.aidltest.Book _arg0;</span><br><span class="line">                if ((0 != data.readInt())) &#123;</span><br><span class="line">                    _arg0 = android.tplink.sjj.aidltest.Book.CREATOR.createFromParcel(data);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    _arg0 = null;</span><br><span class="line">                &#125;</span><br><span class="line">                this.addBook(_arg0);</span><br><span class="line">                reply.writeNoException();</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">            default: &#123;</span><br><span class="line">                return super.onTransact(code, data, reply, flags);</span><br><span class="line">            &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        private static class Proxy implements android.tplink.sjj.aidltest.BookManager &#123;</span><br><span class="line">            private android.os.IBinder mRemote;</span><br><span class="line"></span><br><span class="line">            Proxy(android.os.IBinder remote) &#123;</span><br><span class="line">                mRemote = remote;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public android.os.IBinder asBinder() &#123;</span><br><span class="line">                return mRemote;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            public java.lang.String getInterfaceDescriptor() &#123;</span><br><span class="line">                return DESCRIPTOR;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            /**</span><br><span class="line">             * Demonstrates some basic types that you can use as parameters</span><br><span class="line">             * and return values in AIDL.</span><br><span class="line">             */</span><br><span class="line">            @Override</span><br><span class="line">            public java.util.List&lt;android.tplink.sjj.aidltest.Book&gt; getBooks() throws android.os.RemoteException &#123;</span><br><span class="line">                android.os.Parcel _data = android.os.Parcel.obtain();</span><br><span class="line">                android.os.Parcel _reply = android.os.Parcel.obtain();</span><br><span class="line">                java.util.List&lt;android.tplink.sjj.aidltest.Book&gt; _result;</span><br><span class="line">                try &#123;</span><br><span class="line">                    _data.writeInterfaceToken(DESCRIPTOR);</span><br><span class="line">                    mRemote.transact(Stub.TRANSACTION_getBooks, _data, _reply, 0);</span><br><span class="line">                    _reply.readException();</span><br><span class="line">                    _result = _reply.createTypedArrayList(android.tplink.sjj.aidltest.Book.CREATOR);</span><br><span class="line">                &#125; finally &#123;</span><br><span class="line">                    _reply.recycle();</span><br><span class="line">                    _data.recycle();</span><br><span class="line">                &#125;</span><br><span class="line">                return _result;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void addBook(android.tplink.sjj.aidltest.Book book) throws android.os.RemoteException &#123;</span><br><span class="line">                android.os.Parcel _data = android.os.Parcel.obtain();</span><br><span class="line">                android.os.Parcel _reply = android.os.Parcel.obtain();</span><br><span class="line">                try &#123;</span><br><span class="line">                    _data.writeInterfaceToken(DESCRIPTOR);</span><br><span class="line">                    if ((book != null)) &#123;</span><br><span class="line">                        _data.writeInt(1);</span><br><span class="line">                        book.writeToParcel(_data, 0);</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        _data.writeInt(0);</span><br><span class="line">                    &#125;</span><br><span class="line">                    mRemote.transact(Stub.TRANSACTION_addBook, _data, _reply, 0);</span><br><span class="line">                    _reply.readException();</span><br><span class="line">                &#125; finally &#123;</span><br><span class="line">                    _reply.recycle();</span><br><span class="line">                    _data.recycle();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        static final int TRANSACTION_getBooks = (android.os.IBinder.FIRST_CALL_TRANSACTION + 0);</span><br><span class="line">        static final int TRANSACTION_addBook = (android.os.IBinder.FIRST_CALL_TRANSACTION + 1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Demonstrates some basic types that you can use as parameters</span><br><span class="line">     * and return values in AIDL.</span><br><span class="line">     */</span><br><span class="line">    public java.util.List&lt;android.tplink.sjj.aidltest.Book&gt; getBooks() throws android.os.RemoteException;</span><br><span class="line"></span><br><span class="line">    public void addBook(android.tplink.sjj.aidltest.Book book) throws android.os.RemoteException;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>&ensp;&ensp;简单的说，通过AIDL，AS构建了统一的跨进程通信接口和相应的Binder，其内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public interface BookManager extends android.os.IInterface &#123;</span><br><span class="line"></span><br><span class="line">public static abstract class Stub extends android.os.Binder implements android.tplink.sjj.aidltest.BookManager</span><br><span class="line">    public java.util.List&lt;android.tplink.sjj.aidltest.Book&gt; getBooks() throws android.os.RemoteException;</span><br><span class="line">    public void addBook(android.tplink.sjj.aidltest.Book book) throws android.os.RemoteException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>&ensp;&ensp;标准化后的AIDL继承了IInterface这个系统接口，内部有一个binder子类和我们定义的两个接口。</p><h3 id="Stub文件"><a href="#Stub文件" class="headerlink" title="Stub文件"></a>Stub文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public static abstract class Stub extends android.os.Binder implements android.tplink.sjj.aidltest.BookManager &#123;</span><br><span class="line">    private static final java.lang.String DESCRIPTOR = &quot;android.tplink.sjj.aidltest.BookManager&quot;;</span><br><span class="line">    </span><br><span class="line">    public Stub() &#123; ...... &#125;</span><br><span class="line"></span><br><span class="line">    public static android.tplink.sjj.aidltest.BookManager asInterface(android.os.IBinder obj) &#123; ...... &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public android.os.IBinder asBinder() &#123; ...... &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onTransact(int code, android.os.Parcel data, android.os.Parcel reply, int flags) throws android.os.RemoteException &#123; ......&#125;</span><br><span class="line"></span><br><span class="line">    private static class Proxy implements android.tplink.sjj.aidltest.BookManager &#123; ...... &#125;</span><br><span class="line"></span><br><span class="line">    static final int TRANSACTION_getBooks = (android.os.IBinder.FIRST_CALL_TRANSACTION + 0);</span><br><span class="line">    static final int TRANSACTION_addBook = (android.os.IBinder.FIRST_CALL_TRANSACTION + 1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Stub内部结构"><a href="#Stub内部结构" class="headerlink" title="Stub内部结构"></a>Stub内部结构</h3><h4 id="Stub描述符"><a href="#Stub描述符" class="headerlink" title="Stub描述符"></a>Stub描述符</h4><p>&ensp;&ensp;Stub继承了系统的Binder类并且实现了我们自定义的接口，继承了系统Binder类，就可以走系统那一套，可以将自己注册到ServerManger中，其中有自己的一个引用和一个唯一的描述符：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DESCRIPTOR = &quot;android.tplink.sjj.aidltest.BookManager&quot;;</span><br></pre></td></tr></table></figure><p>&ensp;&ensp;这样客户端请求服务端时，就可以用这个描述符进行检索并判断客户端和服务端是否在同一进程内，具体代码后面分析；实现的接口中有我们自定义的方法，这个方法通过Binder机制完成跨进程调用。<br>&ensp;&ensp;Stub构造函数就是构造该Binder子类，其中应该涉及到将自己注册到ServerManager的过程（具体待验证）；<br>&ensp;&ensp;asInterface()方法代码如下，我们结合具体代码分析它的功能：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public static android.tplink.sjj.aidltest.BookManager asInterface(android.os.IBinder obj) &#123;</span><br><span class="line">           if ((obj == null)) &#123;</span><br><span class="line">               return null;</span><br><span class="line">           &#125;</span><br><span class="line">           android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR);</span><br><span class="line">           if (((iin != null) &amp;&amp; (iin instanceof android.tplink.sjj.aidltest.BookManager))) &#123;</span><br><span class="line">               return ((android.tplink.sjj.aidltest.BookManager) iin);</span><br><span class="line">           &#125;</span><br><span class="line">           return new android.tplink.sjj.aidltest.BookManager.Stub.Proxy(obj);</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure><p>&ensp;&ensp;该方法传入的是一个Binder接口，方法先判空，非空情况下，在本地池（C/S同一个进程情况）中检索该服务，用的就是该binder的描述符，如果检索到，则直接返回该引用，说明传入的参数就是客户端所需的服务的引用；如果没有在本地检索到，说明这是一个跨进程的调用，返回该binder的一个代理Proxy。<br>&ensp;&ensp;asBinder返回自身，一般是在服务端（四大组件Service的bindService方法中返回Binder的引用），该引用作为客户端调用服务端的凭据。</p><h4 id="Stub内部类Proxy"><a href="#Stub内部类Proxy" class="headerlink" title="Stub内部类Proxy"></a>Stub内部类Proxy</h4><p>&ensp;&ensp;Proxy类是Stub类的内部类，Stub通过它可以完成远程代理。Proxy对客户透明，就如同其他系统服务AMS、WMS、PMS和UMS等等，也是通过代理为客户端（app进程）提供服务。实现代码如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">private static class Proxy implements android.tplink.sjj.aidltest.BookManager &#123;</span><br><span class="line">           private android.os.IBinder mRemote;</span><br><span class="line"></span><br><span class="line">           Proxy(android.os.IBinder remote) &#123;</span><br><span class="line">               mRemote = remote;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           @Override</span><br><span class="line">           public android.os.IBinder asBinder() &#123;</span><br><span class="line">               return mRemote;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           public java.lang.String getInterfaceDescriptor() &#123;</span><br><span class="line">               return DESCRIPTOR;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           /**</span><br><span class="line">            * Demonstrates some basic types that you can use as parameters</span><br><span class="line">            * and return values in AIDL.</span><br><span class="line">            */</span><br><span class="line">           @Override</span><br><span class="line">           public java.util.List&lt;android.tplink.sjj.aidltest.Book&gt; getBooks() throws android.os.RemoteException &#123;</span><br><span class="line">               android.os.Parcel _data = android.os.Parcel.obtain();</span><br><span class="line">               android.os.Parcel _reply = android.os.Parcel.obtain();</span><br><span class="line">               java.util.List&lt;android.tplink.sjj.aidltest.Book&gt; _result;</span><br><span class="line">               try &#123;</span><br><span class="line">                   _data.writeInterfaceToken(DESCRIPTOR);</span><br><span class="line">                   mRemote.transact(Stub.TRANSACTION_getBooks, _data, _reply, 0);</span><br><span class="line">                   _reply.readException();</span><br><span class="line">                   _result = _reply.createTypedArrayList(android.tplink.sjj.aidltest.Book.CREATOR);</span><br><span class="line">               &#125; finally &#123;</span><br><span class="line">                   _reply.recycle();</span><br><span class="line">                   _data.recycle();</span><br><span class="line">               &#125;</span><br><span class="line">               return _result;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           @Override</span><br><span class="line">           public void addBook(android.tplink.sjj.aidltest.Book book) throws android.os.RemoteException &#123;</span><br><span class="line">               android.os.Parcel _data = android.os.Parcel.obtain();</span><br><span class="line">               android.os.Parcel _reply = android.os.Parcel.obtain();</span><br><span class="line">               try &#123;</span><br><span class="line">                   _data.writeInterfaceToken(DESCRIPTOR);</span><br><span class="line">                   if ((book != null)) &#123;</span><br><span class="line">                       _data.writeInt(1);</span><br><span class="line">                       book.writeToParcel(_data, 0);</span><br><span class="line">                   &#125; else &#123;</span><br><span class="line">                       _data.writeInt(0);</span><br><span class="line">                   &#125;</span><br><span class="line">                   mRemote.transact(Stub.TRANSACTION_addBook, _data, _reply, 0);</span><br><span class="line">                   _reply.readException();</span><br><span class="line">               &#125; finally &#123;</span><br><span class="line">                   _reply.recycle();</span><br><span class="line">                   _data.recycle();</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure><p>&ensp;&ensp;Proxy利用binder接口中的transact方法，将序列化后的客户端请求参数传送到服务端，并把服务端的数据用同样的方法解析出来返回给客户端，具体需要依赖底层binder驱动。</p><h4 id="Stub中的接口描述符"><a href="#Stub中的接口描述符" class="headerlink" title="Stub中的接口描述符"></a>Stub中的接口描述符</h4><p>&ensp;&ensp;可以看到Proxy调用_mRemote.tranact()方法时第一个参数是Stub.TRANSACTION_addBook，它和binder描述符类似，也是一个描述符，只不过它是标识调用的方法，服务端接收到Proxy的请求后，通过该参数路由到具体的方法，我们定义的方法有两个，它们的描述符如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">static final int TRANSACTION_getBooks = (android.os.IBinder.FIRST_CALL_TRANSACTION + 0);</span><br><span class="line">      static final int TRANSACTION_addBook = (android.os.IBinder.FIRST_CALL_TRANSACTION + 1);</span><br></pre></td></tr></table></figure><p>看过AMS源码的同行应该很熟悉这些代码，在IActivityManager中有大量的方法描述符。</p><h4 id="Stub中的onTransact方法"><a href="#Stub中的onTransact方法" class="headerlink" title="Stub中的onTransact方法"></a>Stub中的onTransact方法</h4><p>&ensp;&ensp;然后再看看Stub的onTransact中：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public boolean onTransact(int code, android.os.Parcel data, android.os.Parcel reply, int flags) throws android.os.RemoteException &#123;</span><br><span class="line">    java.lang.String descriptor = DESCRIPTOR;</span><br><span class="line">    switch (code) &#123;</span><br><span class="line">    case INTERFACE_TRANSACTION: &#123;</span><br><span class="line">        reply.writeString(descriptor);</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">    case TRANSACTION_getBooks: &#123;</span><br><span class="line">        data.enforceInterface(descriptor);</span><br><span class="line">        java.util.List&lt;android.tplink.sjj.aidltest.Book&gt; _result = this.getBooks();</span><br><span class="line">        reply.writeNoException();</span><br><span class="line">        reply.writeTypedList(_result);</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">    case TRANSACTION_addBook: &#123;</span><br><span class="line">        data.enforceInterface(descriptor);</span><br><span class="line">        android.tplink.sjj.aidltest.Book _arg0;</span><br><span class="line">        if ((0 != data.readInt())) &#123;</span><br><span class="line">            _arg0 = android.tplink.sjj.aidltest.Book.CREATOR.createFromParcel(data);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            _arg0 = null;</span><br><span class="line">        &#125;</span><br><span class="line">        this.addBook(_arg0);</span><br><span class="line">        reply.writeNoException();</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">    default: &#123;</span><br><span class="line">        return super.onTransact(code, data, reply, flags);</span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以看到，onTransact中的操作和Proxy中的transact是一一对应的，那边发出的请求这边根据binder描述符合接口描述符进行处理，有返回数据时，就写入reply这个数据结构中，依赖底层binder传递给客户端。</p><h3 id="AIDL调用流程"><a href="#AIDL调用流程" class="headerlink" title="AIDL调用流程"></a>AIDL调用流程</h3><p>&ensp;&ensp;根据上面分析，binder跨进程调用通过Proxy实现，Stub和Proxy都实现了我们定义的接口，所有客户端调用都一一对应到服务端，底层的一切包括代理都对客户没有影响，客户端就好像调用本地方法一样。我们传输的参数对象需要序列化，具体可以查一下Parcel接口和原理相关知识。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>android app闪退原因总结分析</title>
      <link href="2019/03/20/android-app%E9%97%AA%E9%80%80%E5%8E%9F%E5%9B%A0%E6%80%BB%E7%BB%93%E5%88%86%E6%9E%90/"/>
      <url>2019/03/20/android-app%E9%97%AA%E9%80%80%E5%8E%9F%E5%9B%A0%E6%80%BB%E7%BB%93%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h2 id="Android内存泄露概述"><a href="#Android内存泄露概述" class="headerlink" title="Android内存泄露概述"></a>Android内存泄露概述</h2><p>&ensp;&ensp;了解Android内存泄露之前，需要对java的内存管理和GC机制有个简单的了解。<br>&ensp;&ensp;Android内存泄露的根本原因是引用者的生命周期大于被引用者。举个例子，有对象A，B，B有A的强引用，GC要回收A时发现B还未销毁，所以A也未能被回收。</p><h2 id="Android的内存泄露后果"><a href="#Android的内存泄露后果" class="headerlink" title="Android的内存泄露后果"></a>Android的内存泄露后果</h2><ol><li>直接后果是，内存泄露导致空间浪费，最终导致内存溢出；</li><li>间接后果是，内存不足导致频繁GC，系统性能下降<h2 id="Android内存泄露场景"><a href="#Android内存泄露场景" class="headerlink" title="Android内存泄露场景"></a>Android内存泄露场景</h2></li><li>单例模式中引用四大组建，最常见的是单例中引用Activity的context，导致该Activity在内存中存活的周期和Application一样长，GC无法正常回收。<br>&ensp;&ensp;解决办法：单例模式应用ApplicationContext，该引用和应用的生命周期一样长</li><li>非静态内部类或匿名内部类，该类对象持有外部类的强引用，如果该类的对象进行耗时操作，无法短期内被回收，那他持有的外部对象也无法及时回收，典型场景有：匿名Thread类异步执行耗时操作，非静态Handler对象，其中有未完成的异步信息。<br>&ensp;&ensp;解决办法：内部类如果任务繁重，可以考虑使用静态内部类，静态内部类独立于外部类存在，典型的应用场景如RecyclerView中的VIewHolder。</li><li>集合中存储静态对象，导致集合占用的空间无法及时释放。<br>&ensp;&ensp;解决办法：。。。</li><li>资源没有关闭，例如文件操作、网络流、广播未注销、Service脱离Activity未停止运行、观察者模式未解除监听等等。<br>&ensp;&ensp;解决办法：养成良好的编程习惯，成对出现的open，close要一起使用。<h2 id="补充学习一下java的各种引用"><a href="#补充学习一下java的各种引用" class="headerlink" title="补充学习一下java的各种引用"></a>补充学习一下java的各种引用</h2></li><li>强引用：最通用的引用，比如 B  b = new B()，b就是一个强引用，这样该引用存在，GC就不会回收，这也是导致java内存泄露的根本原因；</li><li>软引用：当内存不够时，GC会先回收这类引用；SoftReference<B> bs = SoftReference<B>(b)；</li><li>弱引用：当GC发现一个对象只有弱引用时，马上回收它，WeakReference<B> sr = new WeakReference<B>(b)；</li><li>虚引用：类似于占位符，不影响实际对象的生命周期，GC该怎么做就怎么做。<br>&ensp;&ensp;综上，是java提供的几种引用机制，如果我们加以利用，可以一定程度上减少内存泄露情景，具体用法网上很多，我也正在学习当中。</li></ol>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
